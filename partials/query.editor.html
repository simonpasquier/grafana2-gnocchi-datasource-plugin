<div class="editor-row" style="margin-top: 10px;">

<div  ng-repeat="target in panel.targets"
      style="margin-bottom: 10px;"
      ng-class="{'tight-form-disabled': target.hide}"
      ng-controller="GnocchiQueryCtrl"
      ng-init="init()">

    <div class="tight-form">
        <ul class="tight-form-list pull-right">
            <li class="tight-form-item">
                <a class="pointer" tabindex="1" ng-click="toggleQueryMode()">
                    <i class="fa fa-pencil"></i>
                </a>
            </li>
            <li class="tight-form-item last">
                <a class="pointer" tabindex="1" ng-click="removeDataQuery(target)">
                    <i class="fa fa-remove"></i>
                </a>
            </li>
        </ul>

        <ul class="tight-form-list">
            <li>
                <a class="tight-form-item"
                   ng-click="target.hide = !target.hide; get_data();"
                   role="menuitem">
                    <i class="fa fa-eye"></i>
                </a>
            </li>
        </ul>

        <ul class="tight-form-list" role="menu">
            <li class="tight-form-item" style="width: 122px" ng-show="target.resQuery">
                Resource search
            </li>
            <li ng-show="target.resQuery">
                <input type="text"
                       class="input-large tight-form-input"
                       ng-model="target.resource_search"
                       spellcheck='false'
                       placeholder="resource search"
                       data-min-length=0
                       ng-model-onblur
                       ng-blur="targetBlur()"
                       >
                       <a bs-tooltip="target.errors.resource_search"
                          style="color: rgb(229, 189, 28)"
                          ng-show="target.errors.resource_search">
                           <i class="fa fa-warning"></i>
                       </a>
            </li>
            <li class="tight-form-item" style="width: 122px" ng-show="target.resQuery"> 
                Metric name
            </li>
            <li ng-show="target.resQuery">
                <input type="text"
                       class="input-large tight-form-input"
                       ng-model="target.metric_name"
                       spellcheck='false'
                       bs-typeahead="suggestMetricsName"
                       placeholder="metric name"
                       data-min-length=0 data-items=100
                       ng-model-onblur
                       ng-blur="targetBlur()"
                       >
                       <a bs-tooltip="target.errors.metric_name"
                          style="color: rgb(229, 189, 28)"
                          ng-show="target.errors.metric_name">
                           <i class="fa fa-warning"></i>
                       </a>
            </li>

            <li class="tight-form-item" style="width: 122px" ng-hide="target.resQuery">
                Metric
            </li>
            <li ng-hide="target.resQuery">
                <input type="text"
                       class="input-large tight-form-input"
                       ng-model="target.metric"
                       spellcheck='false'
                       bs-typeahead="suggestMetrics"
                       placeholder="metric id"
                       data-min-length=0 data-items=100
                       ng-model-onblur
                       ng-blur="targetBlur()"
                       >
                       <a bs-tooltip="target.errors.metric"
                          style="color: rgb(229, 189, 28)"
                          ng-show="target.errors.metric">
                           <i class="fa fa-warning"></i>
                       </a>
            </li>
            <li class="tight-form-item">
                Aggregator
            </li>
            <li>
                <select ng-model="target.aggregator"
                        class="tight-form-input input-small"
                        ng-options="agg for agg in aggregators"
                        ng-change="targetBlur()">
                </select>
                <a bs-tooltip="target.errors.aggregator"
                   style="color: rgb(229, 189, 28)"
                   ng-show="target.errors.aggregator">
                    <i class="fa fa-warning"></i>
                </a>
            </li>
            <li class="tight-form-item" style="width: 122px" ng-show="target.resQuery">
                Label attribute
            </li>
            <li ng-show="target.resQuery">
                <input type="text"
                       class="input-large tight-form-input"
                       ng-model="target.label"
                       spellcheck='false'
                       placeholder="id"
                       data-min-length=0
                       ng-model-onblur
                       ng-blur="targetBlur()"
                       >
                       <a bs-tooltip="target.errors.label"
                          style="color: rgb(229, 189, 28)"
                          ng-show="target.errors.label">
                           <i class="fa fa-warning"></i>
                       </a>
            </li>

        </ul>

        <div class="clearfix"></div>
    </div>
</div>
</div>
